# Next

Version: V1
Type: Technique
Date de cr√©ation: 14 d√©cembre 2023 16:00
Derni√®re modification: 14 d√©cembre 2023 16:02

üîó [Tutoriel React](https://react.dev/learn/tutorial-tic-tac-toe)

üîó [Penser React](https://react.dev/learn/thinking-in-react)

## üèóÔ∏è Installation

üîó [Documentation officielle chapitre ‚Äúinstallation‚Äù de React](https://react.dev/learn/start-a-new-react-project)

üîó [Documentation officielle chapitre ‚Äúinstallation‚Äù de Nextjs](https://nextjs.org/docs/getting-started/installation)

Next.js est un framework pour React destin√© √† cr√©er des applications Web. Il s‚Äôappuie sur React pour cr√©er des interfaces utilisateur √† l'aide de composants et il fournit aussi une structure, des fonctionnalit√©s et des optimisations suppl√©mentaires pour votre application.

La documentation officielle de React nous invite √† utiliser React au travers un framework comme Nextjs, Remix, Gatsby ‚Ä¶ En effet React est une librairie, contrairement √† un framework celui-ci ne fournit pas une palette d‚Äôoutils destin√©s √† nous faciliter la t√¢che, c‚Äôest la o√π intervient Nextjs.

- Liste des fonctionnalit√©s mises √† disposition par Nextjs
    
    
    | Routing | Un routeur bas√© sur un syst√®me de fichiers construit sur des composants serveur qui prend en charge les dispositions, le routage imbriqu√©, les √©tats de chargement, la gestion des erreurs, etc. |
    | --- | --- |
    | Rendering | Rendu c√¥t√© client et c√¥t√© serveur avec des composants client et serveur. Optimis√© davantage avec le rendu statique et dynamique sur le serveur avec Next.js. Streaming sur les environnements d'ex√©cution Edge et Node.js. |
    | Data Fetching | R√©cup√©ration de donn√©es simplifi√©e avec prise en charge asynchrone/attente dans les composants React et l'API fetch()s qui s'aligne sur React et la plate-forme Web. |
    | Styling | Prise en charge de vos m√©thodes de style pr√©f√©r√©es, y compris les modules CSS, Tailwind CSS et CSS-in-JS |
    | Optimizations | Optimisations des images, des polices et des scripts pour am√©liorer les √©l√©ments vitaux Web de base et l'exp√©rience utilisateur de votre application. |
    | Typescript | Prise en charge am√©lior√©e de TypeScript, avec une meilleure v√©rification de type et une compilation plus efficace, ainsi qu'un plug-in TypeScript personnalis√© et un v√©rificateur de type. |
    | API Reference | Mises √† jour de la conception de l'API dans Next.js. Veuillez vous r√©f√©rer √† la section de r√©f√©rence de l'API pour les nouvelles API. |

- **1. Installation**
    
    Cr√©er un projet Nextjs
    
    ```bash
    npx create-next-app@latest
    ```
    
    Prompt √† la cr√©ation :
    
    ```bash
    What is your project named?                                           -> nom de votre projet
    Would you like to use TypeScript with this project? No / Yes          -> √† vous de voir
    Would you like to use ESLint with this project? No / Yes              -> √† vous de voir
    Would you like to use Tailwind CSS with this project? No / Yes        -> √† vous de voir
    Would you like to use `src/` directory with this project? No / Yes    -> oui
    Use App Router (recommended)? No / Yes                                -> oui
    Would you like to customize the default import alias? No / Yes        -> √† vous de voir
    ```
    
- **2. D√©marrer l‚Äôapplication**
    
    Ex√©cuter le serveur
    
    ```bash
    npm run dev // rendez-vous sur http://localhost:3000
    ```
    
- **3. Architecture du projet initialis√©**
    
    
    ![next_1.png](next/next_1.png)
    
    **üí°√Ä savoir :**
    
    Depuis la version 13 de Nextjs, l‚Äôarborescence du projet ( sous-entendu l‚Äôarborescence des pages de notre site web ) va √™tre d√©fini par l‚Äôorganisation de nos dossiers et fichiers au sein du dossier `src/app`.
    
    ‚ö†Ô∏è Si vous avez choisi d‚Äôutiliser Typescript vos fichier React ( les fichiers contenant un/des composant(s) React ) devront utiliser l‚Äôextension `.tsx`, si vous utilisez Javascript alors l‚Äôextension est `.jsx`.
    
- **4. Styles**
    
    üîó [Documentation officielle chapitre ‚Äústyle‚Äù](https://nextjs.org/docs/app/building-your-application/styling)
    
    Next.js prend en charge les modules CSS utilisant l'extension .module.css, exemple : `header.module.css`, `footer.module.css`.
    
    Les modules CSS cr√©er automatiquement un nom de classe unique. Cela vous permet d'utiliser le m√™me nom de classe dans diff√©rents fichiers sans vous soucier des collisions. Ce comportement fait des modules CSS le moyen id√©al d'inclure du CSS au niveau des composants.
    
    ‚ÑπÔ∏è Dans le JSX l‚Äôattribut HTML `class` est remplac√© par `className`, exemple : `<div className="ma-class-css">...</div>`.
    
    ‚ÑπÔ∏è Les modules CSS sont une fonctionnalit√© facultative et ne sont activ√©s que pour les fichiers avec l'extension `.module.css`.
    
    - Exemple avec la cr√©ation d‚Äôun header :
        
        
        1. Cr√©er une feuille de style sp√©cifique au composant `Header.tsx`.
        2. Importer la feuille CSS dans le composant `Header.tsx`.
        3. Attribuer la classes souhait√© √† l‚Äô√©l√©ment souhait√©, ici je donne la classe `header` √† la div englobant tout le header
        
        - üíª Exemple d‚Äôun composant `Header.tsx`
            
            ```jsx
            import styles from './header.module.css'
             
            export default function Header() {
              return (
            		<div className={styles.header}>
            			<h1>Maglecorp</h1>
            			<nav>
            				<ul>
            					<li>
            						<a href='#'>Lien 1</a>
            					</li>
            					<li>
            						<a href='#'>Lien 2</a>
            					</li>
            				</ul>
            			</nav>
            		</div>
            	)
            }
            ```
            
        - üíª Exemple d‚Äôune feuille de style `header.module.css`
            
            ```jsx
            .header {
              padding: 24px;
            }
            
            .header > h1 {
            	color: red;
            }
            
            .header > nav > ul {
            	list-style-type: none;
            }
            ```
            
        
    - Utiliser SASS / SCSS :
        
        Installer la librairie SASS.
        
        ```bash
        npm install --save-dev sass
        ```
        
        Ajouter la configuration indiqu√©es dans la document Next dans le fichier `next.config.js`.
        
        ```jsx
        const path = require('path')
        
        /** @type {import('next').NextConfig} */
        const nextConfig = {
            sassOptions: {
                includePaths: [path.join(__dirname, 'styles')],
            },
        }
        
        module.exports = nextConfig
        ```
        

## üõ£Ô∏è Page et routing

üîó [Documentation officielle chapitre ‚Äúfondamentaux du routing‚Äù](https://nextjs.org/docs/app/building-your-application/routing)

üîó [Documentation officielle chapitre ‚Äúrouting‚Äù](https://nextjs.org/docs/app/building-your-application/routing/defining-routes)

üîó [Documentation officielle chapitre ‚Äúrouting dynamique‚Äù](https://nextjs.org/docs/app/building-your-application/routing/dynamic-routes)

- **1. Syst√®me de routing**
    
    Next.js utilise un routeur bas√© sur un syst√®me de fichiers o√π les dossiers sont utilis√©s pour d√©finir les itin√©raires.
    
    ‚ÑπÔ∏è Chaque dossier repr√©sente un segment de route qui correspond √† un segment d'URL. Pour cr√©er une route imbriqu√©e, vous pouvez imbriquer des dossiers les uns dans les autres.
    
    ![next_routing_3.png](next/next_routing_3.png)
    
    Ici le dossier `src` est celui initialis√© par la commande de cr√©ation d‚Äôun projet Next. Par d√©faut celui-ci contient un dossier `app`, ce dossier correspond √† la racine du routing de notre application.
    
    Au sein de ce dossier l‚Äôon retrouve diff√©rents fichiers qui seront abord√©s plus tard, pour l‚Äôinstant nous nous concentrerons sur le fichier `page.tsx`. Ce sont les fichiers ( un par dossier ) `page.tsx` qui permettent de rendre des pages de notre application accessible publiquement.
    
    ![next_routing_4.png](next/next_routing_4.png)
    
    Ici nous avons ajout√© un dossier `contact` au sein du dossier `app`, ce nouveau dossier contient un fichier `page.tsx`, par cons√©quent la route `/contact` est bien accessible. Si jamais le dossier avait √©t√© cr√©√© mais ne contenait pas le fichier `page.tsx` alors la route `/contact` retournerait une erreur 404.
    
    ![next_routing_5.png](next/next_routing_5.png)
    
    Ici nous avons ajout√© un dossier `help` ( et son fichier `page.tsx` ) au sein du dossier `contact` pour rendre disponible la route `/contact/help`.
    
- **2. Routing dynamique**
    
    Le routeur bas√© sur un syst√®me de fichiers de Next permet de d√©finir des routes dynamiques en mettant entre crochet le nom du dossier.
    
    Il est possible d‚Äôimbriquer une route dynamique dans une autre.
    
    | Route | Example URL | params |
    | --- | --- | --- |
    | app/blog/[slug]/page.js | /blog/aventure | { slug: 'aventure' } |
    | app/shop/[product]/page.js | /shop/coca-cola | { product: 'coca-cola' } |
    | app/results/[team]/page.js | /results/om | { team: 'om' } |
    | app/results/[sport]/[team]/page.js | /results/football/om | { sport: 'football', team: 'om' } |
    
    Avec l‚Äôarchitecture de dossiers suivante : `app/shop/[product]/page.js` l‚Äôutilisateur peut se rendre sur la page `https://magle-corp/shop/coca-cola`.
    
    Dans le composant React `app/shop/[product]/page.js` il va alors √™tre possible de r√©cup√©rer le param√®tre dynamique de l‚ÄôURL, ici  `[product]`.
    
    Pour cela il faut exploiter les param√®tres re√ßut par notre composant ( ces param√®tres sont mis √† disposition par Next, il faut juste les appeler).
    
    ```bash
    export default function ProductDetail({ params }) {
        console.log(params) // retourne { product: 'coca-cola' }
        
        return (
            <p>Page d√©tail d'un produit</p>
        )
    }
    ```
    
- **3. Structure et convention**
    
    üîó [Documentation officielle chapitre ‚Äústructure d‚Äôun projet‚Äù](https://nextjs.org/docs/getting-started/project-structure)
    
    Si vous cr√©ez un fichier avec l‚Äôun des noms ci-dessous au sein d‚Äôun dossier de routing celui-ci sera reconnu par Next et b√©n√©ficiera d‚Äôun comportement sp√©cifique, exemple :
    
    les fichiers `page.tsx` sont reconnus comme √©tant la page public √† afficher d‚Äôun dossier.
    
    ‚ö†Ô∏è le fichier `layout.tsx` du dossier `app` ne doit pas √™tre supprim√©.
    
    | layout | Interface utilisateur partag√©e pour un segment et ses enfants |
    | --- | --- |
    | page | Interface utilisateur unique d'un itin√©raire et rend les itin√©raires accessibles au public |
    | loading | Chargement de l'interface utilisateur pour un segment et ses enfants |
    | not-found | Interface utilisateur introuvable pour un segment et ses enfants |
    | error | Interface utilisateur d'erreur pour un segment et ses enfants |
    | global-error | Interface utilisateur d'erreur globale |
    | route | Point de terminaison de l'API c√¥t√© serveur |
    | template | Interface utilisateur de mise en page restitu√©e sp√©cialis√©e |
    | default | Interface utilisateur de secours pour les routes parall√®les |
    

## üó∫Ô∏è Navigation

üîó [Documentation officielle chapitre ‚Äúliens et navigation‚Äù](https://nextjs.org/docs/app/building-your-application/routing/linking-and-navigating)

Next met √† disposition un composant de lien appel√© `<Link>...</Link>`. Il est recommand√© d‚Äôutiliser ce composant pour cr√©er des liens entre vos pages car celui-ci permet de pre-fetch les pages point√©es par les liens contenus dans une page, par exemple :

Sur votre homepage vous avez un lien vers votre page de contact et un second vers celle de votre profil. Lorsque votre homepage est charg√©e Next pre-fetch les pages contact et profil afin d‚Äôavoir de meilleures performances lorsque l‚Äôutilisateur se rendra sur l‚Äôune de ces pages.

```jsx
import Link from 'next/link'
 
export default function Menu() {
  return (
		<ul>
			<li>
				<Link href="/portfolio">Travaux</Link>
			</li>
			<li>
				<Link href="/profile">Profil</Link>
			</li>
			<li>
				<Link href="/contact">Contact</Link>
			</li>
		</ul>
	)
}
```

‚ÑπÔ∏è Rien ne change dans le cas ou votre lien pointe vers une route dynamique.

```jsx
import Link from 'next/link'
 
export default function PostList({ posts }) {
  return (
    <ul>
      {posts.map((post) => (
        <li key={post.id}>
          <Link href={`/article/${post.id}`}>{post.title}</Link>
        </li>
      ))}
    </ul>
  )
} 
```

## üìÇ Routing Files

üîó [Documentation officielle chapitre ‚Äúapp convention du router‚Äù](https://nextjs.org/docs/getting-started/project-structure#app-routing-conventions)

Comme vu dans le chapitre ‚Äúpage et routing‚Äù, au sous-chapitre ‚Äústructure et convention‚Äù il existe une liste de noms de fichier r√©serv√©s, ceux-ci sont interpr√©t√©s diff√©remment par Next.

Ces fichiers sont imbriqu√©es les un dans les autres et r√©pondent √† un besoin specific.

- `not-found.tsx`
    
    üîó [Documentation d√©taill√©](https://nextjs.org/docs/app/api-reference/file-conventions/not-found)
    
    Le fichier `not-found.tsx` est utilis√© pour adapter l‚Äôinterface utilisateur lorsque la page qu‚Äôil requ√™te n‚Äôexiste pas, Next renverra √©galement un code d'√©tat HTTP 404.
    
- `layout.tsx`
    
    üîó [Documentation d√©taill√©](https://nextjs.org/docs/app/api-reference/file-conventions/layout)
    
    Le fichier `layout.tsx` est utilis√© pour d√©finir un interface utilisateur partag√©e entre les routes.
    
- `loading.tsx`
    
    üîó [Documentation d√©taill√©](https://nextjs.org/docs/app/api-reference/file-conventions/loading)
    
    Le fichier `loading.tsx` est utilis√© pour d√©finir l‚Äôinterface utilisateur affich√© lorsque le composant ( serveur ou client ) est en chargement.
    
    Par d√©faut, ce fichier est un composant serveur mais peut √©galement √™tre utilis√© comme composant client via la directive `"use client"`.
    
- `error.tsx`
    
    üîó [Documentation d√©taill√©](https://nextjs.org/docs/app/api-reference/file-conventions/error)
    
    Le fichier `error.tsx` est utilis√© pour d√©finir l'interface utilisateur lorsque la page rencontre une erreur.
    
- `page.tsx`
    
    üîó [Documentation d√©taill√©](https://nextjs.org/docs/app/api-reference/file-conventions/page)
    
    L‚Äôinterface utilisateur d‚Äôune page.
    

Si nous d√©finissons un fichier de chaque √† la racine du routing ( donc dans le dossier `app` ), ceux-ci seront appel√©s, si n√©cessaire, partout dans l‚Äôapplication. Cela peut av√©rer utile pour d√©finir des √©l√©ments d‚Äôinterface utilisateurs commun √† toute l‚Äôapplication. Exemple : d√©finir l‚Äôinterface utilisateur d‚Äôune page 404 gr√¢ce au `not-found.tsx`

Dans le cas o√π nous souhaiterions adapter, par exemple, l‚Äôinterface utilisateur lors du chargement de la page `app/contact/page.tsx` il est possible de cr√©er un fichier `loading.tsx` dans le dossier `contact`. Celui-ci prendra le dessus sur le `loading.tsx` de la racine.

‚ö†Ô∏è Ce n‚Äôest pas le cas avec le fichier `layout.tsx`. Si nous d√©finissons un `app/contact/layout.tsx` celui-ci sera imbriqu√© dans le `app/layout.tsx`.

![component_hierarchy_0.png](next/component_hierarchy_0.png)

![componenent_hierarchy_1.png](next/componenent_hierarchy_1.png)